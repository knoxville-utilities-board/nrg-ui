{"version":3,"file":"on-click-outside.js","sources":["../../src/modifiers/on-click-outside.ts"],"sourcesContent":["import { registerDestructor } from '@ember/destroyable';\nimport { action } from '@ember/object';\nimport { guidFor } from '@ember/object/internals';\nimport { tracked } from '@glimmer/tracking';\nimport Modifier from 'ember-modifier';\n\nimport type Owner from '@ember/owner';\n\ntype Named = {\n  disabled?: boolean;\n};\ntype Positional = [(evt: MouseEvent, ...args: unknown[]) => unknown];\ntype Element = HTMLElement;\n\nexport interface OnClickOutsideSignature {\n  Args: {\n    Named: Named;\n    Positional: Positional;\n  };\n  Element: Element;\n}\n\nfunction cleanup(instance: OnClickOutside) {\n  delete instance.element?.dataset['clickHandler'];\n  document.documentElement.removeEventListener('click', instance.clickHandler, true);\n}\n\nexport default class OnClickOutside extends Modifier<OnClickOutsideSignature> {\n  @tracked\n  declare element: Element;\n\n  @tracked\n  declare callback: Positional[0];\n\n  @tracked\n  declare named: Named;\n\n  guid = guidFor(this);\n\n  constructor(owner: Owner, args: { named: Named; positional: Positional }) {\n    super(owner, args);\n\n    registerDestructor(this, cleanup);\n  }\n\n  get disabled() {\n    return this.named?.disabled;\n  }\n\n  modify(element: Element, positional: Positional, named: Named) {\n    this.element = element;\n    this.callback = positional[0];\n    this.named = named;\n\n    cleanup(this);\n\n    element.dataset['clickHandler'] = this.guid;\n    document.documentElement.addEventListener('click', this.clickHandler, true);\n  }\n\n  @action\n  clickHandler(evt: MouseEvent, ...args: unknown[]) {\n    const foundTargetInWrapper = (evt.target as HTMLElement).closest(\n      `[data-click-handler=${this.guid}]`,\n    );\n    if (!foundTargetInWrapper && !this.disabled) {\n      this.callback(evt, ...args);\n    }\n    return false;\n  }\n}\n"],"names":["cleanup","instance","element","dataset","document","documentElement","removeEventListener","clickHandler","OnClickOutside","Modifier","g","prototype","tracked","i","guid","guidFor","constructor","owner","args","registerDestructor","disabled","named","modify","positional","callback","addEventListener","evt","foundTargetInWrapper","target","closest","n","action"],"mappings":";;;;;;;AAsBA,SAASA,OAAOA,CAACC,QAAwB,EAAE;AACzC,EAAA,OAAOA,QAAQ,CAACC,OAAO,EAAEC,OAAO,CAAC,cAAc,CAAC;AAChDC,EAAAA,QAAQ,CAACC,eAAe,CAACC,mBAAmB,CAAC,OAAO,EAAEL,QAAQ,CAACM,YAAY,EAAE,IAAI,CAAC;AACpF;AAEe,MAAMC,cAAc,SAASC,QAAQ,CAA0B;AAAA,EAAA;IAAAC,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,SAAA,EAAA,CAC3EC,OAAO,CAAA,CAAA;AAAA;EAAA,QAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,SAAA,CAAA,EAAA,MAAA;AAAA,EAAA;IAAAH,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,UAAA,EAAA,CAGPC,OAAO,CAAA,CAAA;AAAA;EAAA,SAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,UAAA,CAAA,EAAA,MAAA;AAAA,EAAA;IAAAH,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,OAAA,EAAA,CAGPC,OAAO,CAAA,CAAA;AAAA;EAAA,MAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,OAAA,CAAA,EAAA,MAAA;AAGRC,EAAAA,IAAI,GAAGC,OAAO,CAAC,IAAI,CAAC;AAEpBC,EAAAA,WAAWA,CAACC,KAAY,EAAEC,IAA8C,EAAE;AACxE,IAAA,KAAK,CAACD,KAAK,EAAEC,IAAI,CAAC;AAElBC,IAAAA,kBAAkB,CAAC,IAAI,EAAEnB,OAAO,CAAC;AACnC,EAAA;EAEA,IAAIoB,QAAQA,GAAG;AACb,IAAA,OAAO,IAAI,CAACC,KAAK,EAAED,QAAQ;AAC7B,EAAA;AAEAE,EAAAA,MAAMA,CAACpB,OAAgB,EAAEqB,UAAsB,EAAEF,KAAY,EAAE;IAC7D,IAAI,CAACnB,OAAO,GAAGA,OAAO;AACtB,IAAA,IAAI,CAACsB,QAAQ,GAAGD,UAAU,CAAC,CAAC,CAAC;IAC7B,IAAI,CAACF,KAAK,GAAGA,KAAK;IAElBrB,OAAO,CAAC,IAAI,CAAC;IAEbE,OAAO,CAACC,OAAO,CAAC,cAAc,CAAC,GAAG,IAAI,CAACW,IAAI;AAC3CV,IAAAA,QAAQ,CAACC,eAAe,CAACoB,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAClB,YAAY,EAAE,IAAI,CAAC;AAC7E,EAAA;AAGAA,EAAAA,YAAYA,CAACmB,GAAe,EAAE,GAAGR,IAAe,EAAE;AAChD,IAAA,MAAMS,oBAAoB,GAAID,GAAG,CAACE,MAAM,CAAiBC,OAAO,CAC9D,CAAA,oBAAA,EAAuB,IAAI,CAACf,IAAI,GAClC,CAAC;AACD,IAAA,IAAI,CAACa,oBAAoB,IAAI,CAAC,IAAI,CAACP,QAAQ,EAAE;AAC3C,MAAA,IAAI,CAACI,QAAQ,CAACE,GAAG,EAAE,GAAGR,IAAI,CAAC;AAC7B,IAAA;AACA,IAAA,OAAO,KAAK;AACd,EAAA;AAAC,EAAA;IAAAY,CAAA,CAAA,IAAA,CAAAnB,SAAA,EAAA,cAAA,EAAA,CATAoB,MAAM,CAAA,CAAA;AAAA;AAUT;;;;"}