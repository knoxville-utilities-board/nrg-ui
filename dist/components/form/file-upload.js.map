{"version":3,"file":"file-upload.js","sources":["../../../src/components/form/file-upload.gts"],"sourcesContent":["import { assert, runInDebug } from '@ember/debug';\nimport { registerDestructor } from '@ember/destroyable';\nimport { fn } from '@ember/helper';\nimport { on } from '@ember/modifier';\nimport { action } from '@ember/object';\nimport { htmlSafe } from '@ember/template';\nimport Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { t } from 'ember-intl';\nimport { runTask, scheduleTask } from 'ember-lifeline';\nimport { modifier } from 'ember-modifier';\nimport { TrackedArray } from 'tracked-built-ins';\n\nimport BoundValue from './bound-value.ts';\nimport { classes } from '../../helpers/classes.ts';\nimport onInsert from '../../modifiers/on-insert.ts';\nimport { FileValidator } from '../../validation/index.ts';\nimport Button from '../button.gts';\n\nimport type { BoundValueSignature } from './bound-value.ts';\nimport type { FieldOptions } from './field.gts';\nimport type Owner from '@ember/owner';\n\nexport interface SelectedFileListSignature {\n  Args: {\n    disabled?: boolean;\n    files: File[] | null;\n    isInvalid?: boolean;\n    isWarning?: boolean;\n    onRemove?: (index: number) => void;\n  };\n  Element: HTMLUListElement;\n  Blocks: {\n    default: [];\n  };\n}\n\nexport type FileUploadSignature = BoundValueSignature<\n  {\n    Args: {\n      accept?: string[];\n\n      fieldOptions?: FieldOptions;\n      validatorKey?: string;\n\n      onAdd?: (files: File[]) => unknown;\n      onRemove?: (file: File) => unknown;\n    };\n    Blocks: {\n      default: [];\n    };\n    Element: HTMLDivElement;\n  },\n  File[]\n>;\n\nclass SelectedFileList extends Component<SelectedFileListSignature> {\n  @action\n  removeFile(index: number) {\n    this.args.onRemove?.(index);\n  }\n\n  <template>\n    {{#if @files}}\n      <div class=\"m-0 p-0 col-12\">\n        <ul\n          class={{classes\n            \"list-group list-group-flush rounded p-0 col-12 form-control\"\n            (if @isInvalid \"is-invalid\")\n            (if @isWarning \"is-warning\")\n          }}\n        >\n          {{#each @files as |file index|}}\n            <li\n              class=\"col-12 list-group-item d-flex flex-row align-items-center justify-content-between\"\n            >\n              {{file.name}}\n              {{#unless @disabled}}\n                <Button data-test-remove class=\"btn-link\" @onClick={{fn this.removeFile index}}>\n                  {{t \"nrg.file-upload.remove\"}}\n                </Button>\n              {{/unless}}\n            </li>\n          {{/each}}\n        </ul>\n      </div>\n    {{else}}\n      <div\n        class={{classes \"form-control\" (if @isInvalid \"is-invalid\") (if @isWarning \"is-warning\")}}\n      >\n        <p class=\"text-muted m-0\">{{t \"nrg.file-upload.noFiles\"}}</p>\n      </div>\n    {{/if}}\n  </template>\n}\n\nexport default class FileUpload extends BoundValue<FileUploadSignature, File[]> {\n  validatorId?: string;\n\n  @tracked\n  inputElement?: HTMLInputElement;\n\n  @tracked\n  isDraggingOver = false;\n\n  constructor(owner: Owner, args: FileUploadSignature['Args']) {\n    super(owner, args);\n    registerDestructor(this, () => {\n      this.setupValidator();\n    });\n\n    if (!(this.value instanceof TrackedArray)) {\n      scheduleTask(this, 'actions', () => {\n        this.onChange(new TrackedArray(this.value ?? []));\n      });\n    }\n  }\n\n  get accept() {\n    if (this.args.accept) {\n      runInDebug(() => {\n        for (const type of this.args.accept ?? []) {\n          const fileExtension = type.startsWith('.');\n          const mimeType = type.includes('/');\n          if (!fileExtension && !mimeType) {\n            assert(\n              'The accept argument\\'s file type strings should be in the format \"image/png\" or \".pdf\" to be compatible with the input\\'s \"accept\" attribute.',\n            );\n          }\n        }\n      });\n      return (this.args.accept as string[])?.join(', ');\n    }\n    return '';\n  }\n\n  get dropzoneStyling() {\n    let style = 'border-style: dashed !important;';\n    if (this.args.fieldOptions?.disabled) {\n      style += 'cursor: not-allowed !important;';\n    }\n    return style;\n  }\n\n  get validatorKey() {\n    return this.args.validatorKey ?? this.args.binding!.valuePath;\n  }\n\n  filterDuplicateFiles(files: FileList): File[] {\n    if (!this.value || this.value!.length === 0) {\n      return Array.from(files);\n    }\n    const filteredFiles = [];\n    for (const newFile of files) {\n      if (!this.value!.some((file) => file.name === newFile.name)) {\n        filteredFiles.push(newFile);\n      }\n    }\n    return filteredFiles;\n  }\n\n  @action\n  handleCancel(event: Event) {\n    event.preventDefault();\n    event.stopPropagation();\n  }\n\n  @action\n  handleDragover(event: DragEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.args.fieldOptions?.disabled) {\n      return;\n    }\n    this.isDraggingOver = true;\n  }\n\n  @action\n  handleDrop(event: DragEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.args.fieldOptions?.disabled) {\n      return;\n    }\n    this.isDraggingOver = false;\n\n    const files = event.dataTransfer?.files;\n    this.change(files!);\n  }\n\n  @action\n  initInput(element: HTMLElement) {\n    this.inputElement = element as HTMLInputElement;\n  }\n\n  @action\n  change(files: FileList) {\n    if (this.args.fieldOptions?.disabled) {\n      return;\n    }\n\n    const value = this.value ?? [];\n\n    if (files && files.length > 0) {\n      const filteredFiles = this.filterDuplicateFiles(files);\n      value.push(...filteredFiles);\n      this.onChange(value);\n      this.args.onAdd?.(filteredFiles);\n    }\n  }\n\n  @action\n  openInput(event: MouseEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.inputElement!.value = '';\n    this.inputElement!.click();\n  }\n\n  @action\n  removeFile(index: number) {\n    if (this.args.fieldOptions?.disabled) {\n      return;\n    }\n    const [removedFile] = this.value!.splice(index, 1);\n    this.onChange(this.value);\n    this.args.onRemove?.(removedFile!);\n  }\n\n  @action\n  setupValidator(accept?: string[]) {\n    const { binding } = this.args;\n    const { form } = this.args.fieldOptions ?? {};\n\n    if (!form || !binding) {\n      return;\n    }\n\n    if (accept) {\n      if (this.validatorId) {\n        form.unregisterBinding(this.validatorKey);\n        form.unregisterValidator(this.validatorKey, this.validatorId);\n      }\n\n      const fileValidator = new FileValidator(binding, { acceptedTypes: accept }, binding.model);\n      this.validatorId = form.registerValidator(fileValidator, this.validatorKey);\n    } else {\n      if (!this.validatorId) {\n        return;\n      }\n\n      form.unregisterValidator(this.validatorKey, this.validatorId);\n      this.validatorId = undefined;\n    }\n  }\n\n  setupValidatorModifier = modifier((element: unknown, [accept]: [string[] | undefined]) => {\n    runTask(this, () => this.setupValidator(accept));\n  });\n\n  @action\n  toggleIsDragging(isDragging: boolean) {\n    if (this.args.fieldOptions?.disabled) {\n      return;\n    }\n    this.isDraggingOver = isDragging;\n  }\n\n  @action\n  updateValue(event: Event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const inputFiles = this.inputElement?.files;\n    this.change(inputFiles!);\n  }\n\n  <template>\n    <div\n      class={{classes\n        \"form-control-plaintext p-0\"\n        (if @fieldOptions.isInvalid \"is-invalid\")\n        (if @fieldOptions.isWarning \"is-warning\")\n      }}\n      {{this.setupValidatorModifier @accept}}\n      ...attributes\n    >\n      <div\n        style={{htmlSafe this.dropzoneStyling}}\n        class=\"p-4 border border-2 rounded-3 d-flex flex-row align-items-center\n          {{if @fieldOptions.disabled 'bg-body-secondary'}}\n          {{if this.isDraggingOver 'bg-body-tertiary'}}\"\n        {{on \"dragover\" this.handleDragover}}\n        {{on \"dragenter\" (fn this.toggleIsDragging true)}}\n        {{on \"dragend\" (fn this.toggleIsDragging false)}}\n        {{on \"dragleave\" (fn this.toggleIsDragging false)}}\n        {{on \"drop\" this.handleDrop}}\n      >\n        <div\n          class={{classes\n            \"w-100 d-flex flex-column flex-md-row align-items-center justify-content-center my-4\"\n            (if @fieldOptions.disabled \"text-body-tertiary\")\n          }}\n          data-test-drop-zone\n        >\n          <i class=\"bi bi-file-earmark-text mx-2 fs-4\" />\n          <p class=\"m-0\">\n            {{t \"nrg.file-upload.dragAndDrop\"}}\n          </p>\n          <Button\n            class=\"btn btn-link p-0 m-0 ms-1 fst-italic\"\n            @disabled={{@fieldOptions.disabled}}\n            @onClick={{this.openInput}}\n            @text={{t \"nrg.file-upload.selectFiles\"}}\n            data-test-open=\"input\"\n          />\n          <input\n            accept={{this.accept}}\n            aria-describedby={{@fieldOptions.describedBy}}\n            disabled={{@fieldOptions.disabled}}\n            hidden\n            id={{@fieldOptions.id}}\n            multiple\n            type=\"file\"\n            {{on \"change\" this.updateValue}}\n            {{on \"cancel\" this.handleCancel}}\n            {{onInsert this.initInput}}\n          />\n        </div>\n      </div>\n      <div class=\"d-flex flex-column align-items-center p-0 mt-1\">\n        <SelectedFileList\n          @disabled={{@fieldOptions.disabled}}\n          @files={{this.value}}\n          @isInvalid={{@fieldOptions.isInvalid}}\n          @isWarning={{@fieldOptions.isWarning}}\n          @onRemove={{this.removeFile}}\n        />\n      </div>\n    </div>\n  </template>\n}\n"],"names":["SelectedFileList","Component","removeFile","index","args","onRemove","n","prototype","action","setComponentTemplate","precompileTemplate","strictMode","scope","classes","Button","fn","t","FileUpload","BoundValue","validatorId","g","tracked","i","constructor","owner","registerDestructor","setupValidator","value","TrackedArray","scheduleTask","onChange","accept","runInDebug","type","fileExtension","startsWith","mimeType","includes","assert","join","dropzoneStyling","style","fieldOptions","disabled","validatorKey","binding","valuePath","filterDuplicateFiles","files","length","Array","from","filteredFiles","newFile","some","file","name","push","handleCancel","event","preventDefault","stopPropagation","handleDragover","isDraggingOver","handleDrop","dataTransfer","change","initInput","element","inputElement","onAdd","openInput","click","removedFile","splice","form","unregisterBinding","unregisterValidator","fileValidator","FileValidator","acceptedTypes","model","registerValidator","undefined","setupValidatorModifier","modifier","runTask","toggleIsDragging","isDragging","updateValue","inputFiles","htmlSafe","on","onInsert"],"mappings":"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"}