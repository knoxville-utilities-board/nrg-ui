{"version":3,"file":"password.js","sources":["../../../src/validation/validators/password.ts"],"sourcesContent":["import { assert } from '@ember/debug';\nimport { tKey } from 'ember-intl';\n\nimport BaseValidator from './base.ts';\n\nimport type { BaseOptions, ValidateFnResponse } from '../types.ts';\n\nconst CommonTests = {\n  alpha: /[a-zA-Z]/,\n  upper: /[A-Z]/,\n  lower: /[a-z]/,\n  numeral: /\\d/,\n  special: /[^A-Za-z0-9]/,\n};\n\nexport type PasswordOptions = {\n  /**\n   * A list of tests to run against the password.\n   * Each test must be either a regular expression or one of the following values: \"alpha\", \"upper\", \"lower\", \"numeral\", \"special\".\n   */\n  tests: (RegExp | keyof typeof CommonTests)[];\n  /**\n   * The minimum number of character types required from the list of `tests`.\n   */\n  minClasses: number;\n} & BaseOptions;\n\nexport default class PasswordValidator<\n  Context extends object = Record<string, unknown>,\n> extends BaseValidator<string, Context, PasswordOptions> {\n  defaultOptions = {\n    tests: Object.keys(CommonTests) as (keyof typeof CommonTests)[],\n    minClasses: 3,\n  };\n\n  validate(value: string, options: PasswordOptions): ValidateFnResponse {\n    const { minClasses, tests } = options;\n\n    assert('PasswordValidator requires `minClasses` to be provided', minClasses);\n\n    assert(\n      'PasswordValidator requires `minClasses` to be less than or equal to the number of tests provided',\n      minClasses <= tests.length,\n    );\n\n    const applicableTests: RegExp[] = tests.map((test) => {\n      if (typeof test === 'string') {\n        assert(`Invalid test key: ${test}`, test in CommonTests);\n\n        return CommonTests[test];\n      }\n\n      return test;\n    });\n\n    const classCount = applicableTests.map((test) => test.test(value)).filter(Boolean).length;\n\n    if (classCount >= minClasses) {\n      return true;\n    }\n\n    return {\n      key: tKey('nrg.validation.password.strength'),\n      value,\n    };\n  }\n}\n"],"names":["CommonTests","alpha","upper","lower","numeral","special","PasswordValidator","BaseValidator","defaultOptions","tests","Object","keys","minClasses","validate","value","options","assert","length","applicableTests","map","test","classCount","filter","Boolean","key","tKey"],"mappings":";;;;AAOA,MAAMA,WAAW,GAAG;AAClBC,EAAAA,KAAK,EAAE,UAAU;AACjBC,EAAAA,KAAK,EAAE,OAAO;AACdC,EAAAA,KAAK,EAAE,OAAO;AACdC,EAAAA,OAAO,EAAE,IAAI;AACbC,EAAAA,OAAO,EAAE;AACX,CAAC;AAcc,MAAMC,iBAAiB,SAE5BC,aAAa,CAAmC;AACxDC,EAAAA,cAAc,GAAG;AACfC,IAAAA,KAAK,EAAEC,MAAM,CAACC,IAAI,CAACX,WAAW,CAAiC;AAC/DY,IAAAA,UAAU,EAAE;GACb;AAEDC,EAAAA,QAAQA,CAACC,KAAa,EAAEC,OAAwB,EAAsB;IACpE,MAAM;MAAEH,UAAU;AAAEH,MAAAA;AAAM,KAAC,GAAGM,OAAO;AAErCC,IAAAA,MAAM,CAAC,wDAAwD,EAAEJ,UAAU,CAAC;IAE5EI,MAAM,CACJ,kGAAkG,EAClGJ,UAAU,IAAIH,KAAK,CAACQ,MACtB,CAAC;AAED,IAAA,MAAMC,eAAyB,GAAGT,KAAK,CAACU,GAAG,CAAEC,IAAI,IAAK;AACpD,MAAA,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;QAC5BJ,MAAM,CAAC,qBAAqBI,IAAI,CAAA,CAAE,EAAEA,IAAI,IAAIpB,WAAW,CAAC;QAExD,OAAOA,WAAW,CAACoB,IAAI,CAAC;AAC1B,MAAA;AAEA,MAAA,OAAOA,IAAI;AACb,IAAA,CAAC,CAAC;IAEF,MAAMC,UAAU,GAAGH,eAAe,CAACC,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACA,IAAI,CAACN,KAAK,CAAC,CAAC,CAACQ,MAAM,CAACC,OAAO,CAAC,CAACN,MAAM;IAEzF,IAAII,UAAU,IAAIT,UAAU,EAAE;AAC5B,MAAA,OAAO,IAAI;AACb,IAAA;IAEA,OAAO;AACLY,MAAAA,GAAG,EAAEC,IAAI,CAAC,kCAAkC,CAAC;AAC7CX,MAAAA;KACD;AACH,EAAA;AACF;;;;"}