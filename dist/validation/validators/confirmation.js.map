{"version":3,"file":"confirmation.js","sources":["../../../src/validation/validators/confirmation.ts"],"sourcesContent":["import { assert } from '@ember/debug';\nimport { get } from '@ember/object';\nimport { isEqual, isPresent } from '@ember/utils';\nimport { tKey } from 'ember-intl';\n\nimport BaseValidator from './base.ts';\n\nimport type { Binding } from '../../index.ts';\nimport type { BaseOptions, Computable, TranslatableOption, ValidateFnResponse } from '../types';\n\nexport type ConfirmationOptions = {\n  /**\n   * When building the error message, this will be used as the label for the field.\n   * If not provided, the `on` property will be used.\n   */\n  label?: string;\n  /**\n   * If `true`, the value must not match the value of the property specified by `on`.\n   */\n  inverse?: boolean;\n  /**\n   * The property name to compare the value against.\n   */\n  on: string;\n} & BaseOptions;\n\nexport default class ConfirmationValidator<\n  Context extends object = Record<string, TranslatableOption>,\n> extends BaseValidator<TranslatableOption, Context, ConfirmationOptions> {\n  constructor(\n    binding: Binding,\n    options: Computable<Context, ConfirmationOptions>,\n    context?: Context,\n  ) {\n    super(binding, options, context);\n\n    const { on } = options;\n\n    assert('ConfirmationValidator requires a property name `on` to be provided', isPresent(on));\n  }\n\n  validate(\n    value: TranslatableOption,\n    options: ConfirmationOptions,\n    context: Context,\n  ): ValidateFnResponse {\n    const { label, inverse, on } = options;\n\n    const expectedValue = get(context, on) as TranslatableOption;\n\n    const matches = isEqual(value, expectedValue);\n    let key: string = tKey('nrg.validation.confirmation.invalid');\n\n    if (!inverse && matches) {\n      return true;\n    }\n\n    if (inverse) {\n      key = tKey('nrg.validation.confirmation.match');\n      if (!matches) {\n        return true;\n      }\n    }\n\n    return {\n      key,\n      value,\n      expectedValue,\n      label: label ?? on,\n    };\n  }\n}\n"],"names":["ConfirmationValidator","BaseValidator","constructor","binding","options","context","on","assert","isPresent","validate","value","label","inverse","expectedValue","get","matches","isEqual","key","tKey"],"mappings":";;;;;;AA0Be,MAAMA,qBAAqB,SAEhCC,aAAa,CAAmD;AACxEC,EAAAA,WAAWA,CACTC,OAAgB,EAChBC,OAAiD,EACjDC,OAAiB,EACjB;AACA,IAAA,KAAK,CAACF,OAAO,EAAEC,OAAO,EAAEC,OAAO,CAAC;IAEhC,MAAM;AAAEC,MAAAA;AAAG,KAAC,GAAGF,OAAO;AAEtBG,IAAAA,MAAM,CAAC,oEAAoE,EAAEC,SAAS,CAACF,EAAE,CAAC,CAAC;AAC7F,EAAA;AAEAG,EAAAA,QAAQA,CACNC,KAAyB,EACzBN,OAA4B,EAC5BC,OAAgB,EACI;IACpB,MAAM;MAAEM,KAAK;MAAEC,OAAO;AAAEN,MAAAA;AAAG,KAAC,GAAGF,OAAO;AAEtC,IAAA,MAAMS,aAAa,GAAGC,GAAG,CAACT,OAAO,EAAEC,EAAE,CAAuB;AAE5D,IAAA,MAAMS,OAAO,GAAGC,OAAO,CAACN,KAAK,EAAEG,aAAa,CAAC;AAC7C,IAAA,IAAII,GAAW,GAAGC,IAAI,CAAC,qCAAqC,CAAC;AAE7D,IAAA,IAAI,CAACN,OAAO,IAAIG,OAAO,EAAE;AACvB,MAAA,OAAO,IAAI;AACb,IAAA;AAEA,IAAA,IAAIH,OAAO,EAAE;AACXK,MAAAA,GAAG,GAAGC,IAAI,CAAC,mCAAmC,CAAC;MAC/C,IAAI,CAACH,OAAO,EAAE;AACZ,QAAA,OAAO,IAAI;AACb,MAAA;AACF,IAAA;IAEA,OAAO;MACLE,GAAG;MACHP,KAAK;MACLG,aAAa;MACbF,KAAK,EAAEA,KAAK,IAAIL;KACjB;AACH,EAAA;AACF;;;;"}